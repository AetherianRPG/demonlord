{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: attribute\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>Choose Attribute:</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">Strength</option>\n          <option value=\"Agility\">Agility</option>\n          <option value=\"Intellect\">Intellect</option>\n          <option value=\"Will\">Will</option>\n          <option value=\"Perception\">Perception</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>Boons/Banes:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: `Request Roll`,\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: `Cancel`\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"m3RJhHOGDUTIQkuU","name":"Request Initiative Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a Initiative Roll from the selected tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestInitRoll(token) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    var templateData = {\n        actor: actor\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makeinitroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nfor (let token of canvas.tokens.controlled) {\n    requestInitRoll(token);\n}","author":"Sd8TaawsSgOTEPU7","img":"icons/svg/d20.svg","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>Choose Attribute:</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + CONFIG.DL.attributes['strength'] + `</option>\n          <option value=\"Agility\">` + CONFIG.DL.attributes['agility'] + `</option>\n          <option value=\"Intellect\">` + CONFIG.DL.attributes['intellect'] + `</option>\n          <option value=\"Will\">` + CONFIG.DL.attributes['will'] + `</option>\n          <option value=\"Perception\">` + CONFIG.DL.attributes['perception'] + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>Boons/Banes:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: `Request Roll`,\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: `Cancel`\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>Choose Attribute:</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + CONFIG.DL.attributes['strength'] + `</option>\n          <option value=\"Agility\">` + CONFIG.DL.attributes['agility'] + `</option>\n          <option value=\"Intellect\">` + CONFIG.DL.attributes['intellect'] + `</option>\n          <option value=\"Will\">` + CONFIG.DL.attributes['will'] + `</option>\n          <option value=\"Perception\">` + CONFIG.DL.attributes['perception'] + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: `Request Roll`,\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: `Cancel`\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>Choose Attribute:</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + CONFIG.DL.attributes['strength'] + `</option>\n          <option value=\"Agility\">` + CONFIG.DL.attributes['agility'] + `</option>\n          <option value=\"Intellect\">` + CONFIG.DL.attributes['intellect'] + `</option>\n          <option value=\"Will\">` + CONFIG.DL.attributes['will'] + `</option>\n          <option value=\"Perception\">` + CONFIG.DL.attributes['perception'] + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: `Request Roll`,\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: `Cancel`\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.MacroChallengeChoose') + `</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + game.i18n.localize('DL.AttributeStrength') + `</option>\n          <option value=\"Agility\">` + game.i18n.localize('DL.AttributeAgility') + `</option>\n          <option value=\"Intellect\">` + game.i18n.localize('DL.AttributeIntellect') + `</option>\n          <option value=\"Will\">` + game.i18n.localize('DL.AttributeWill') + `</option>\n          <option value=\"Perception\">` + game.i18n.localize('DL.CharPerception') + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: `Request Roll`,\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: `Cancel`\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.MacroChallengeChoose') + `</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + game.i18n.localize('DL.AttributeStrength') + `</option>\n          <option value=\"Agility\">` + game.i18n.localize('DL.AttributeAgility') + `</option>\n          <option value=\"Intellect\">` + game.i18n.localize('DL.AttributeIntellect') + `</option>\n          <option value=\"Will\">` + game.i18n.localize('DL.AttributeWill') + `</option>\n          <option value=\"Perception\">` + game.i18n.localize('DL.CharPerception') + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: `Request Roll`,\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: `Cancel`\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.MacroChallengeChoose') + `</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + game.i18n.localize('DL.AttributeStrength') + `</option>\n          <option value=\"Agility\">` + game.i18n.localize('DL.AttributeAgility') + `</option>\n          <option value=\"Intellect\">` + game.i18n.localize('DL.AttributeIntellect') + `</option>\n          <option value=\"Will\">` + game.i18n.localize('DL.AttributeWill') + `</option>\n          <option value=\"Perception\">` + game.i18n.localize('DL.CharPerception') + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: `Request Roll`,\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: `Cancel`\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.MacroChallengeChoose') + `</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + game.i18n.localize('DL.AttributeStrength') + `</option>\n          <option value=\"Agility\">` + game.i18n.localize('DL.AttributeAgility') + `</option>\n          <option value=\"Intellect\">` + game.i18n.localize('DL.AttributeIntellect') + `</option>\n          <option value=\"Will\">` + game.i18n.localize('DL.AttributeWill') + `</option>\n          <option value=\"Perception\">` + game.i18n.localize('DL.CharPerception') + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: `Request Roll`,\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: `Cancel`\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.MacroChallengeChoose') + `</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + game.i18n.localize('DL.AttributeStrength') + `</option>\n          <option value=\"Agility\">` + game.i18n.localize('DL.AttributeAgility') + `</option>\n          <option value=\"Intellect\">` + game.i18n.localize('DL.AttributeIntellect') + `</option>\n          <option value=\"Will\">` + game.i18n.localize('DL.AttributeWill') + `</option>\n          <option value=\"Perception\">` + game.i18n.localize('DL.CharPerception') + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: game.i18n.localize('DL.MacroChallengeRequestRoll'),\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: game.i18n.localize('DL.MacroCancel')\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.MacroChallengeChoose') + `</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + game.i18n.localize('DL.AttributeStrength') + `</option>\n          <option value=\"Agility\">` + game.i18n.localize('DL.AttributeAgility') + `</option>\n          <option value=\"Intellect\">` + game.i18n.localize('DL.AttributeIntellect') + `</option>\n          <option value=\"Will\">` + game.i18n.localize('DL.AttributeWill') + `</option>\n          <option value=\"Perception\">` + game.i18n.localize('DL.CharPerception') + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: game.i18n.localize('DL.MacroChallengeRequestRoll'),\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: game.i18n.localize('DL.MacroCancel')\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.MacroChallengeChoose') + `</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + game.i18n.localize('DL.AttributeStrength') + `</option>\n          <option value=\"Agility\">` + game.i18n.localize('DL.AttributeAgility') + `</option>\n          <option value=\"Intellect\">` + game.i18n.localize('DL.AttributeIntellect') + `</option>\n          <option value=\"Will\">` + game.i18n.localize('DL.AttributeWill') + `</option>\n          <option value=\"Perception\">` + game.i18n.localize('DL.CharPerception') + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: game.i18n.localize('DL.MacroChallengeRequestRoll'),\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: game.i18n.localize('DL.MacroCancel')\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.MacroChallengeChoose') + `</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + game.i18n.localize('DL.AttributeStrength') + `</option>\n          <option value=\"Agility\">` + game.i18n.localize('DL.AttributeAgility') + `</option>\n          <option value=\"Intellect\">` + game.i18n.localize('DL.AttributeIntellect') + `</option>\n          <option value=\"Will\">` + game.i18n.localize('DL.AttributeWill') + `</option>\n          <option value=\"Perception\">` + game.i18n.localize('DL.CharPerception') + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: game.i18n.localize('DL.MacroChallengeRequestRoll'),\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: game.i18n.localize('DL.MacroCancel')\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: `Request Challenge Roll`,\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.MacroChallengeChoose') + `</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + game.i18n.localize('DL.AttributeStrength') + `</option>\n          <option value=\"Agility\">` + game.i18n.localize('DL.AttributeAgility') + `</option>\n          <option value=\"Intellect\">` + game.i18n.localize('DL.AttributeIntellect') + `</option>\n          <option value=\"Will\">` + game.i18n.localize('DL.AttributeWill') + `</option>\n          <option value=\"Perception\">` + game.i18n.localize('DL.CharPerception') + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: game.i18n.localize('DL.MacroChallengeRequestRoll'),\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: game.i18n.localize('DL.MacroCancel')\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
{"_id":"6PMGvBHfkWXTsLJV","name":"Request Challenge Roll","permission":{"default":0,"Sd8TaawsSgOTEPU7":3},"type":"script","flags":{},"scope":"global","command":"// GM Tool\n// Lets you request a challenge roll from the select tokens. Each token owner gets a whisper message asking them to make a roll.\n\nfunction requestRoll(token, attribute, boonsbanes) {\n    const actor = token.actor;\n    let users = game.users.filter(user => user.active);\n\n    var targets = [];\n    for (let user of users) {\n        if (actor.data.permission[user.id])\n            targets.push(user.id);\n    }\n\n    let boonsbanestext = \"\";\n    if (boonsbanes == 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoon');\n    if (boonsbanes > 1)\n        boonsbanestext = boonsbanes + \" \" + game.i18n.localize('DL.DialogBoons');\n    if (boonsbanes == -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBane');\n    if (boonsbanes < -1)\n        boonsbanestext = boonsbanes.replace(\"-\", \"\") + \" \" + game.i18n.localize('DL.DialogBanes');\n\n    var templateData = {\n        actor: actor,\n        data: {\n            attribute: {\n                value: CONFIG.DL.attributes[attribute.toLowerCase()]\n            },\n            boonsbanes: {\n                value: boonsbanes\n            },\n            boonsbanestext: {\n                value: boonsbanestext\n            }\n        }\n    };\n\n    let chatData = {\n        user: targets[0],\n        speaker: {\n            actor: actor._id,\n            token: actor.token,\n            alias: actor.name\n        }\n    };\n\n    chatData[\"whisper\"] = targets;\n\n    let template = 'systems/demonlord/templates/chat/makechallengeroll.html';\n    renderTemplate(template, templateData).then(content => {\n        chatData.content = content;\n        ChatMessage.create(chatData);\n    });\n}\n\nlet applyChanges = false;\nnew Dialog({\n    title: game.i18n.localize('DL.MacroChallengeTitle'),\n    content: `\n    <form>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.MacroChallengeChoose') + `</label>\n        <select id=\"attribute-type\" name=\"attribute-type\">\n          <option value=\"Strength\">` + game.i18n.localize('DL.AttributeStrength') + `</option>\n          <option value=\"Agility\">` + game.i18n.localize('DL.AttributeAgility') + `</option>\n          <option value=\"Intellect\">` + game.i18n.localize('DL.AttributeIntellect') + `</option>\n          <option value=\"Will\">` + game.i18n.localize('DL.AttributeWill') + `</option>\n          <option value=\"Perception\">` + game.i18n.localize('DL.CharPerception') + `</option>\n        </select>\n      </div>\n      <div class=\"form-group\">\n        <label>` + game.i18n.localize('DL.WeaponBoonsBanes') + `:</label>\n        <input type=\"text\" name=\"boonsbanes\" value=\"0\"/>\n      </div>\n    </form>\n    `,\n    buttons: {\n        yes: {\n            icon: \"<i class='fas fa-check'></i>\",\n            label: game.i18n.localize('DL.MacroChallengeRequestRoll'),\n            callback: () => applyChanges = true\n        },\n        no: {\n            icon: \"<i class='fas fa-times'></i>\",\n            label: game.i18n.localize('DL.MacroCancel')\n        },\n    },\n    default: \"yes\",\n    close: html => {\n        if (applyChanges) {\n            for (let token of canvas.tokens.controlled) {\n                let attribute = html.find('[name=\"attribute-type\"]')[0].value || \"none\";\n                let boonsbanes = html.find('[name=\"boonsbanes\"]')[0].value || \"none\";\n\n                requestRoll(token, attribute, boonsbanes);\n            }\n        }\n    }\n}).render(true);","author":"Sd8TaawsSgOTEPU7","img":"systems/demonlord/icons/skills/challenge.png","actorIds":[]}
