<form class="{{cssClass}} flexcol" autocomplete="off">
    {{> systems/demonlord/templates/actor/new-creature-sidemenu.html}}

    {{!-- Sheet Header --}}
    <header class="sheet-header">
        {{> systems/demonlord/templates/actor/new-creature-header.html}}
    </header>
    <section class="sheet-body">
        <section class="sheet-content">
            <div class="accordion">
                {{#if actor.features}}
                <div class="toggleAccordion change">{{localize "DL.CreatureTraits"}}</div>
                <div class="content" style="display: block;">
                {{else}}
                <div class="toggleAccordion">{{localize "DL.CreatureTraits"}}</div>
                <div class="content" style="display: none;">
                {{/if}}
                    <ol class="items-list">
                        {{#if data.edit}}
                        <li class="item-header">
                            <div class="item-controls">
                                <a class="item-control item-create" title="{{localize 'DL.CreatureTraitsAdd'}}"
                                    data-type="feature"><i class="fas fa-plus"></i></a>
                            </div>
                        </li>
                        {{#each actor.features as |feature id|}}
                        <li class="feature dropitem" data-item-id="{{feature._id}}">
                            <div class="item-controls">
                                <a class="item-control feature-edit" title="{{localize 'DL.FeatureEdit'}}"><i
                                        class="fas fa-edit"></i></a>
                                <a class="item-control feature-delete" title="{{localize 'DL.FeatureDelete'}}"><i
                                        class="fas fa-trash"></i></a>
                            </div>
                            <div class="featurename">{{feature.name}}</div>
                            <div class="featurediscription">{{{feature.data.description}}}
                            </div>
                        </li>
                        {{/each}}
                        {{else}}
                        {{#each actor.features as |feature id|}}
                        <li class="feature dropitem" data-item-id="{{feature._id}}">
                            <div class="featurename">
                                {{feature.name}}
                            </div>
                            <div class="featurediscription">{{{feature.data.description}}}
                            </div>
                        </li>
                        {{/each}}
                        {{/if}}
                    </ol>
                </div>
                {{#if actor.weapons}}
                <div class="toggleAccordion change">{{localize "DL.CreatureAttackOptions"}}</div>
                <div class="content" style="display: block;">
                {{else}}
                <div class="toggleAccordion">{{localize "DL.CreatureAttackOptions"}}</div>
                <div class="content" style="display: none;">
                {{/if}}
                    {{#if data.edit}}
                    <div class="header">
                        <div class="item-controls">
                            <a class="item-control item-create" title="{{localize 'DL.CreatureAddAttackOptions'}}"
                                data-type="weapon"><i class="fas fa-plus"></i></a>
                        </div>
                    </div>
                    {{/if}}
                    <ol class="body">
                        {{#if data.edit}}
                        {{#each actor.weapons as |weapon id|}}
                        <li class="item dropitem" data-item-id="{{weapon._id}}">
                            <div class="itemname">
                                {{weapon.name}}
                                {{#if data.properties}}
                                ({{data.properties}}) {{/if}}
                                {{#if data.action.damage}}
                                ({{data.action.damage}}){{/if}}
                            </div>
                            <div class="item-controls">
                                <a class="item-control item-edit" title="{{localize 'DL.WeaponEdit'}}"><i
                                        class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="{{localize 'DL.WeaponDelete'}}"><i
                                        class="fas fa-trash"></i></a>
                            </div>
                        </li>
                        {{/each}}
                        {{else}}
                        {{#each actor.weapons as |weapon id|}}
                        <li class="item dropitem" data-item-id="{{weapon._id}}">
                            <div class="itemnamefull dropitem attack-roll" data-key="{{id}}"><i class="fas fa-dice-d20"></i> {{weapon.name}}
                                {{#if data.properties}}
                                ({{data.properties}}) {{/if}}{{#if data.action.boonsbanes}}{{localize "DL.CreatureWeaponWith"}}
                                {{numberFormat data.action.boonsbanes decimals=0 sign=true}}{{else}}+0{{/if}}
                                {{#if data.action.boonsbanes}}{{localize "DL.WeaponBoonsBanes"}}{{/if}}
                                {{#if data.action.damage}}
                                ({{data.action.damage}}){{/if}}
                            </div>
                            <div class="itemtext">{{{data.description}}}</div>
                        </li>
                        {{/each}}
                        {{/if}}
                    </ol>
                </div>
                {{#if actor.talents}}
                <div class="toggleAccordion change">{{localize "DL.CreatureSpecialAttacks"}}</div>
                <div class="content" style="display: block;">
                {{else}}
                <div class="toggleAccordion">{{localize "DL.CreatureSpecialAttacks"}}</div>
                <div class="content" style="display: none;">
                {{/if}}
                    {{#if data.edit}}
                    <div class="header">
                        <div class="item-controls">
                            <a class="item-control item-create" title="{{localize 'DL.CreatureAddSpecialAttacks'}}"
                                data-type="talent"><i class="fas fa-plus"></i></a>
                        </div>
                    </div>
                    {{/if}}
                    <ol class="body">
                        {{#if data.edit}}
                        {{#each actor.talents as |item id|}}
                        <li class="item" data-item-id="{{item._id}}">
                            <div class="itemname">{{item.name}}</div>
                            <div class="item-controls">
                                <a class="item-control item-edit" title="{{localize 'DL.CreatureEditSpecialAttacks'}}"><i
                                        class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="{{localize 'DL.CreatureDeleteSpecialAttacks'}}"><i
                                        class="fas fa-trash"></i></a>
                            </div>
                        </li>
                        {{/each}}
                        {{else}}
                        {{#each actor.talents as |item id|}}
                        <li class="item dropitem" data-item-id="{{item._id}}">
                            <div class="itemnamefull talent-roll"><i class="fas fa-dice-d20"></i> {{item.name}}</div>
                            <div class="itemtext">{{{data.description}}}</div>
                        </li>
                        {{/each}}
                        {{/if}}
                    </ol>
                </div>
                {{#if actor.specialactions}}
                <div class="toggleAccordion change">{{localize "DL.CreatureSpecialActions"}}</div>
                <div class="content" style="display: block;">
                {{else}}
                <div class="toggleAccordion">{{localize "DL.CreatureSpecialActions"}}</div>
                <div class="content" style="display: none;">
                {{/if}}
                    {{#if data.edit}}
                    <div class="header">
                        <div class="item-controls">
                            <a class="item-control item-create" title="{{localize 'DL.CreatureAddSpecialActions'}}"
                                data-type="specialaction"><i class="fas fa-plus"></i></a>
                        </div> 
                    </div>
                    {{/if}}
                    <ol class="body">
                        {{#if data.edit}}
                        {{#each actor.specialactions as |item id|}}
                        <li class="item" data-item-id="{{item._id}}">
                            <div class="itemname">{{item.name}}</div>
                            <div class="item-controls">
                                <a class="item-control item-edit" title="{{localize 'DL.CreatureEditSpecialActions'}}"><i
                                        class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="{{localize 'DL.CreatureDeleteSpecialActions'}}"><i
                                        class="fas fa-trash"></i></a>
                            </div>
                        </li>
                        {{/each}}
                        {{else}}
                        {{#each actor.specialactions as |item id|}}
                        <li class="item" data-item-id="{{item._id}}">
                            <div class="itemnamefull">{{item.name}}</div>
                            <div class="itemtext">{{{data.description}}}</div>
                        </li>
                        {{/each}}
                        {{/if}}
                    </ol>
                </div>
                {{#if actor.spellbook}}
                <div class="toggleAccordion change">{{localize "DL.CreatureSpecialMagic"}}</div>
                <div class="content" style="display: block;">
                {{else}}
                <div class="toggleAccordion">{{localize "DL.CreatureSpecialMagic"}}</div>
                <div class="content" style="display: none;">
                {{/if}}
                    {{#if data.edit}}
                    <div class="header">
                        <div class="item-controls">
                            <a class="item-control spell-create" title="{{localize 'DL.MagicAddSpell'}}"
                                    data-type="spell"><i class="fas fa-plus"></i></a>
                        </div>
                    </div>
                    {{/if}}
                    <ol class="body">
                        {{#if data.edit}}
                        {{#each actor.spellbook as |spellbook id|}}
                        <li class="tradition-header">
                            <div class="spellnameheader">{{spellbook.tradition}}</div>
                        </li>
                        {{#each spellbook.spells as |spell id|}}
                        <li class="item spell dropitem" data-item-id="{{spell._id}}">
                            <div class="spellinfo">
                                <div class="itemname">{{spell.name}}</div>
                                <div class="spellcastings">({{data.castings.value}} / {{data.castings.max}}), </div>
                                <div class="spelltype">{{data.spelltype}} {{data.rank}}, </div>
                                <div class="bonesbanes">
                                    {{#if data.action.boonsbanes}}{{numberFormat data.action.boonsbanes decimals=0 sign=true}}{{else}}+0{{/if}}
                                </div>
                                <div class="item-controls">
                                    <a class="item-control spell-edit" title="{{localize 'DL.MagicEditSpell'}}"><i
                                            class="fas fa-edit"></i></a>
                                    <a class="item-control spell-delete" title="{{localize 'DL.MagicDeleteSpell'}}"><i
                                            class="fas fa-trash"></i></a>
                                </div>
                            </div>
                        </li>
                        {{/each}}
                        {{/each}}
                        {{else}}
                        {{#each actor.spellbook as |spellbook id|}}
                        {{#if spellbook.tradition}}
                        <li class="tradition-header">
                            <div class="spellnameheader">{{spellbook.tradition}}</div>
                        </li>
                        {{/if}}
                        {{#each spellbook.spells as |spell id|}}
                        <li class="item spell dropitem creaturetooltip" data-item-id="{{spell._id}}">
                            <div class="spellinfo">
                                <div class="itemname magic-roll"><i class="fas fa-dice-d20"></i> {{spell.name}}</div>
                                <div class="spellcastings spell-uses">({{data.castings.value}} / {{data.castings.max}}), </div>
                                <div class="spelltype">{{data.spelltype}} {{data.rank}}, </div>
                                <div class="bonesbanes">
                                    {{#if data.action.boonsbanes}}{{numberFormat data.action.boonsbanes decimals=0 sign=true}}{{else}}+0{{/if}}
                                </div>
                            </div>
                            {{#if data.description}} 
                            <span class="tooltiptext">{{{data.description}}}</span>
                            {{/if}}
                        </li>
                        {{/each}}
                        {{/each}}
                        {{/if}}
                    </ol>
                </div>
                {{#if actor.specialactions}}
                <div class="toggleAccordion change">{{localize "DL.CreatureSpecialEndRound"}}</div>
                <div class="content" style="display: block;">
                {{else}}
                <div class="toggleAccordion">{{localize "DL.CreatureSpecialEndRound"}}</div>
                <div class="content" style="display: none;">
                {{/if}}
                    {{#if data.edit}}
                    <div class="header">
                        <div class="item-controls">
                            <a class="item-control item-create" title="{{localize 'DL.CreatureAddEndRound'}}"
                                data-type="endoftheround"><i class="fas fa-plus"></i></a>
                        </div>
                    </div>
                    {{/if}}
                    <ol class="body">
                        {{#if data.edit}}
                        {{#each actor.endoftheround as |item id|}}
                        <li class="item" data-item-id="{{item._id}}">
                            <div class="itemname">{{item.name}}</div>
                            <div class="item-controls">
                                <a class="item-control item-edit" title="{{localize 'DL.CreatureEditEndRound'}}"><i
                                        class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="{{localize 'DL.CreatureDeleteEndRound'}}"><i
                                        class="fas fa-trash"></i></a>
                            </div>
                        </li>
                        {{/each}}
                        {{else}}
                        {{#each actor.endoftheround as |item id|}}
                        <li class="item" data-item-id="{{item._id}}">
                            <div class="itemnamefull">{{item.name}}</div>
                            <div class="itemtext">{{{data.description}}}</div>
                        </li>
                        {{/each}}
                        {{/if}}
                    </ol>
                </div>
                {{#if data.description}}
                <div class="toggleAccordion change">{{localize "DL.CreatureDiscription"}}</div>
                <div class="content" style="display: block;">
                {{else}}
                <div class="toggleAccordion">{{localize "DL.CreatureDiscription"}}</div>
                <div class="content" style="display: none;">
                {{/if}}
                    <div class="credescription">
                        {{#if data.edit}}
                        {{editor content=data.description target="data.description" button=true owner=owner editable=editable}}
                        {{else}}
                        {{{data.description}}}
                        {{/if}}
                    </div>
                </div>
            </div>
        </section>
    </section>
</form>